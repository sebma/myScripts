#!/bin/sh -e
#
# rc.local
#
# This script is executed at the end of each multiuser runlevel.
# Make sure that the script will "exit 0" on success or any other
# value on error.
#
# In order to enable or disable this script just change the execution
# bits.
#
# By default this script does nothing.

# Turn Numlock on for the TTYs:
for tty in /dev/tty[1-6]; do
	setleds -D +num < $tty
done

set -x
set +e
grub-install /dev/sda > /rc.local.log 2>&1
sh -x /usr/local/bin/numlockTerms.sh >> /rc.local.log 2>&1
echo "=> Mounted filesystems :" >> /rc.local.log 2>&1
mount | grep ^/dev >> /rc.local.log 2>&1
PATH=$PATH:/usr/local/bin >> /rc.local.log 2>&1
echo "=> PATH = " $PATH >> /rc.local.log 2>&1
echo "=> Unmounting and recreating the </var/cache> filesystem ..." >> /rc.local.log && umount -lv /var/cache >> /rc.local.log 2>&1 && sleep 1 && mkfs.ext4 -v -L /var/cache /dev/KUbuntu_VG/var_cache >> /rc.local.log 2>&1 && mount -v /var/cache >> /rc.local.log 2>&1 && chmod -v 0777 /var/cache >> /rc.local.log 2>&1
echo "=> Unmounting and recreating the </var/tmp> filesystem ...  " >> /rc.local.log && umount -lv /var/tmp   >> /rc.local.log 2>&1 && sleep 1 && mkfs.ext4 -v -L /var/tmp   /dev/KUbuntu_VG/var_tmp   >> /rc.local.log 2>&1 && mount -v /var/tmp   >> /rc.local.log 2>&1 && chmod -v 1777 /var/tmp   >> /rc.local.log 2>&1
ls -ld /var/tmp/kdecache-*/ >> /rc.local.log 2>&1
rm -vfr /var/cache && mkdir -vm777 /var/cache >> /rc.local.log 2>&1
set +x
sync
set -e

exit 0
